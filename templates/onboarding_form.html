<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Registro - sajet.us Multitenant</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet">
	<style>
		:root {
			--color-electric: #00fff5;
			--color-magenta: #ff006e;
			--color-void: #0a0a0f;
			--color-mist: #1a1a2e;
			--font-display: 'Syne', sans-serif;
			--font-mono: 'Space Mono', monospace;
		}
		
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}
		
		body {
			font-family: var(--font-mono);
			background: var(--color-void);
			color: #ffffff;
			overflow-x: hidden;
			min-height: 100vh;
		}
		
		/* Background Effects */
		.grid-bg {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-image: 
				linear-gradient(rgba(0, 255, 245, 0.03) 1px, transparent 1px),
				linear-gradient(90deg, rgba(0, 255, 245, 0.03) 1px, transparent 1px);
			background-size: 40px 40px;
			pointer-events: none;
			z-index: 0;
		}
		
		.orb {
			position: fixed;
			border-radius: 50%;
			filter: blur(100px);
			opacity: 0.2;
			pointer-events: none;
			z-index: 0;
		}
		
		.orb-1 {
			width: 600px;
			height: 600px;
			background: var(--color-electric);
			top: -300px;
			right: 10%;
			animation: float 18s ease-in-out infinite;
		}
		
		.orb-2 {
			width: 500px;
			height: 500px;
			background: var(--color-magenta);
			bottom: -250px;
			left: 10%;
			animation: float 15s ease-in-out infinite reverse;
		}
		
		@keyframes float {
			0%, 100% { transform: translate(0, 0); }
			50% { transform: translate(30px, -30px); }
		}
		
		/* Content Layer */
		.content {
			position: relative;
			z-index: 1;
		}
		
		/* Header */
		header {
			backdrop-filter: blur(20px);
			background: rgba(10, 10, 15, 0.8);
			border-bottom: 1px solid rgba(0, 255, 245, 0.1);
		}
		
		.logo {
			font-family: var(--font-display);
			font-weight: 800;
			font-size: 1.25rem;
			letter-spacing: -0.02em;
			background: linear-gradient(135deg, var(--color-electric), var(--color-magenta));
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
		}
		
		.container {
			max-width: 1400px;
			margin: 0 auto;
			padding: 0 2rem;
		}
		
		/* Form Container */
		.form-wrapper {
			display: grid;
			grid-template-columns: 1fr;
			gap: 4rem;
			padding: 4rem 0;
		}
		
		@media (min-width: 1024px) {
			.form-wrapper {
				grid-template-columns: 5fr 7fr;
				align-items: start;
			}
		}
		
		/* Info Section */
		.info-section {
			animation: slideUp 0.8s ease-out;
		}
		
		@keyframes slideUp {
			from {
				opacity: 0;
				transform: translateY(20px);
			}
			to {
				opacity: 1;
				transform: translateY(0);
			}
		}
		
		.badge {
			font-family: var(--font-display);
			font-weight: 700;
			font-size: 0.75rem;
			background: linear-gradient(135deg, var(--color-electric), var(--color-magenta));
			color: var(--color-void);
			padding: 0.5rem 1rem;
			display: inline-block;
			letter-spacing: 0.1em;
			margin-bottom: 2rem;
			clip-path: polygon(0 0, calc(100% - 8px) 0, 100% 8px, 100% 100%, 8px 100%, 0 calc(100% - 8px));
		}
		
		.info-title {
			font-family: var(--font-display);
			font-weight: 800;
			font-size: clamp(2rem, 5vw, 3.5rem);
			line-height: 1.1;
			letter-spacing: -0.02em;
			margin-bottom: 1.5rem;
		}
		
		.gradient-text {
			background: linear-gradient(135deg, var(--color-electric), var(--color-magenta));
			-webkit-background-clip: text;
			-webkit-text-fill-color: transparent;
			background-clip: text;
		}
		
		.info-desc {
			font-size: 1rem;
			color: rgba(255, 255, 255, 0.7);
			line-height: 1.7;
			margin-bottom: 2rem;
		}
		
		.stats-grid {
			display: grid;
			grid-template-columns: repeat(2, 1fr);
			gap: 1rem;
			margin-top: 2rem;
		}
		
		.stat-card {
			background: rgba(26, 26, 46, 0.5);
			border: 1px solid rgba(0, 255, 245, 0.1);
			padding: 1.5rem;
			clip-path: polygon(0 0, calc(100% - 12px) 0, 100% 12px, 100% 100%, 12px 100%, 0 calc(100% - 12px));
		}
		
		.stat-value {
			font-family: var(--font-display);
			font-weight: 800;
			font-size: 2rem;
			color: var(--color-electric);
			margin-bottom: 0.5rem;
		}
		
		.stat-label {
			font-size: 0.875rem;
			color: rgba(255, 255, 255, 0.6);
		}
		
		/* Form Card */
		.form-card {
			background: rgba(26, 26, 46, 0.5);
			border: 1px solid rgba(0, 255, 245, 0.2);
			padding: 3rem;
			backdrop-filter: blur(20px);
			animation: slideUp 0.8s ease-out 0.2s backwards;
			clip-path: polygon(0 0, calc(100% - 20px) 0, 100% 20px, 100% 100%, 20px 100%, 0 calc(100% - 20px));
		}
		
		.form-header {
			display: flex;
			justify-content: space-between;
			align-items: start;
			margin-bottom: 2rem;
		}
		
		.form-title {
			font-family: var(--font-display);
			font-weight: 700;
			font-size: 1.75rem;
			margin-bottom: 0.25rem;
		}
		
		.form-step {
			font-size: 0.875rem;
			color: rgba(255, 255, 255, 0.5);
			text-transform: uppercase;
			letter-spacing: 0.05em;
		}
		
		.form-icon {
			font-size: 3rem;
			line-height: 1;
		}
		
		/* Form Elements */
		.form-group {
			margin-bottom: 1.5rem;
		}
		
		.form-label {
			display: block;
			font-size: 0.875rem;
			color: rgba(255, 255, 255, 0.7);
			margin-bottom: 0.5rem;
			text-transform: uppercase;
			letter-spacing: 0.05em;
			font-weight: 700;
		}
		
		.form-input {
			width: 100%;
			background: rgba(10, 10, 15, 0.8);
			border: 2px solid rgba(0, 255, 245, 0.2);
			color: #ffffff;
			padding: 0.875rem 1rem;
			font-family: var(--font-mono);
			font-size: 0.9rem;
			transition: all 0.3s;
			clip-path: polygon(0 0, calc(100% - 8px) 0, 100% 8px, 100% 100%, 8px 100%, 0 calc(100% - 8px));
		}
		
		.form-input:focus {
			outline: none;
			border-color: var(--color-electric);
			box-shadow: 0 0 20px rgba(0, 255, 245, 0.2);
		}
		
		.form-input::placeholder {
			color: rgba(255, 255, 255, 0.3);
		}
		
		.input-group {
			display: flex;
		}
		
		.input-addon {
			background: rgba(26, 26, 46, 0.8);
			border: 2px solid rgba(0, 255, 245, 0.2);
			border-left: none;
			color: rgba(255, 255, 255, 0.5);
			padding: 0.875rem 1rem;
			font-family: var(--font-mono);
			font-size: 0.9rem;
			white-space: nowrap;
			clip-path: polygon(0 0, calc(100% - 8px) 0, 100% 8px, 100% 100%, 0 100%, 0 0);
		}
		
		.input-hint {
			font-size: 0.75rem;
			color: rgba(255, 255, 255, 0.4);
			margin-top: 0.5rem;
		}
		
		/* Grid Layout */
		.form-grid {
			display: grid;
			grid-template-columns: 1fr;
			gap: 1.5rem;
		}
		
		@media (min-width: 768px) {
			.form-grid-2 {
				grid-template-columns: repeat(2, 1fr);
			}
		}
		
		/* Plan Selector */
		.plan-grid {
			display: grid;
			grid-template-columns: 1fr;
			gap: 1rem;
			margin-top: 0.5rem;
		}
		
		@media (min-width: 640px) {
			.plan-grid {
				grid-template-columns: repeat(3, 1fr);
			}
		}
		
		.plan-card {
			background: rgba(10, 10, 15, 0.8);
			border: 2px solid rgba(255, 255, 255, 0.1);
			padding: 1.25rem;
			cursor: pointer;
			transition: all 0.3s;
			clip-path: polygon(0 0, calc(100% - 10px) 0, 100% 10px, 100% 100%, 10px 100%, 0 calc(100% - 10px));
		}
		
		.plan-card:hover {
			border-color: var(--color-electric);
			transform: translateY(-2px);
		}
		
		.plan-card.selected {
			border-color: var(--color-magenta);
			background: rgba(255, 0, 110, 0.1);
		}
		
		.plan-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 0.75rem;
		}
		
		.plan-name {
			font-family: var(--font-display);
			font-weight: 700;
			font-size: 1.125rem;
		}
		
		.plan-price {
			font-size: 0.75rem;
			background: rgba(0, 255, 245, 0.1);
			color: var(--color-electric);
			padding: 0.25rem 0.75rem;
			border-radius: 20px;
			font-weight: 700;
		}
		
		.plan-desc {
			font-size: 0.8125rem;
			color: rgba(255, 255, 255, 0.6);
		}
		
		/* Button */
		.btn-submit {
			width: 100%;
			font-family: var(--font-display);
			font-weight: 700;
			font-size: 1rem;
			padding: 1rem 2rem;
			background: var(--color-electric);
			color: var(--color-void);
			border: 2px solid var(--color-electric);
			text-transform: uppercase;
			letter-spacing: 0.05em;
			cursor: pointer;
			transition: all 0.3s;
			margin-top: 1.5rem;
			clip-path: polygon(0 0, calc(100% - 12px) 0, 100% 12px, 100% 100%, 12px 100%, 0 calc(100% - 12px));
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 0.5rem;
		}
		
		.btn-submit:hover {
			background: transparent;
			color: var(--color-electric);
			transform: translateY(-2px);
			box-shadow: 0 10px 30px rgba(0, 255, 245, 0.3);
		}
		
		.btn-submit:disabled {
			opacity: 0.5;
			cursor: not-allowed;
			transform: none;
		}
		
		/* Error Box */
		.error-box {
			background: rgba(255, 0, 110, 0.1);
			border: 1px solid rgba(255, 0, 110, 0.3);
			color: #ff6b9d;
			padding: 1rem;
			margin-top: 1rem;
			font-size: 0.875rem;
			clip-path: polygon(0 0, calc(100% - 10px) 0, 100% 10px, 100% 100%, 10px 100%, 0 calc(100% - 10px));
		}
		
		.hidden {
			display: none;
		}
		
		/* Nav Links */
		.nav-links {
			display: flex;
			gap: 2rem;
			align-items: center;
		}
		
		.nav-link {
			color: rgba(255, 255, 255, 0.7);
			text-decoration: none;
			font-size: 0.875rem;
			transition: color 0.3s;
		}
		
		.nav-link:hover {
			color: var(--color-electric);
		}
	</style>
</head>
<body>
	<!-- Background Effects -->
	<div class="grid-bg"></div>
	<div class="orb orb-1"></div>
	<div class="orb orb-2"></div>
	
	<!-- Content -->
	<div class="content">
		<!-- Header -->
		<header>
			<div class="container" style="padding: 1.5rem 0;">
				<div style="display: flex; justify-content: space-between; align-items: center;">
					<a href="/" class="logo">SAJET.US</a>
					<nav class="nav-links">
						<a href="/login/tenant" class="nav-link">Portal Cliente</a>
						<a href="/login/admin" class="nav-link">Admin</a>
					</nav>
				</div>
			</div>
		</header>

		<!-- Main Content -->
		<main class="container">
			<div class="form-wrapper">
				<!-- Info Section -->
				<div class="info-section">
					<div class="badge">‚ö° ALTA EN 5 MINUTOS</div>
					<h1 class="info-title">
						Crea tu instancia<br/>
						<span class="gradient-text">sajet.us</span><br/>
						en segundos
					</h1>
					<p class="info-desc">
						Automatizamos el pago, el aprovisionamiento en contenedores LXC y la 
						configuraci√≥n inicial. Elige tu plan, ingresa tus datos y te llevamos 
						directo al checkout seguro.
					</p>
					
					<div class="stats-grid">
						<div class="stat-card">
							<div class="stat-value">5min</div>
							<div class="stat-label">Provisioning promedio</div>
						</div>
						<div class="stat-card">
							<div class="stat-value">99.9%</div>
							<div class="stat-label">Disponibilidad</div>
						</div>
					</div>
				</div>

				<!-- Form Section -->
				<div class="form-card">
					<div class="form-header">
						<div>
							<div class="form-step">Paso 1 de 2</div>
							<h2 class="form-title">Datos del titular</h2>
						</div>
						<div class="form-icon">üöÄ</div>
					</div>

					<form id="signupForm">
						<div class="form-grid form-grid-2">
							<div class="form-group">
								<label class="form-label">Nombre Completo</label>
								<input type="text" name="full_name" required class="form-input" placeholder="Andrea L√≥pez" />
							</div>
							<div class="form-group">
								<label class="form-label">Email</label>
								<input type="email" name="email" required class="form-input" placeholder="tu@email.com" />
							</div>
						</div>

						<div class="form-group">
							<label class="form-label">Empresa</label>
							<input type="text" name="company_name" required class="form-input" placeholder="Acme Corp" />
						</div>

						<div class="form-group">
							<label class="form-label">Subdominio</label>
							<div class="input-group">
								<input type="text" name="subdomain" pattern="[a-z0-9]+" required class="form-input" placeholder="miempresa" style="border-right: none;" />
								<div class="input-addon">.sajet.us</div>
							</div>
							<div class="input-hint">Solo min√∫sculas y n√∫meros</div>
						</div>

						<div class="form-group">
							<label class="form-label">Plan</label>
							<input type="hidden" id="selectedPlan" name="plan" value="{{ plan if plan else 'pro' }}" />
							<div class="plan-grid">
								<div class="plan-card" data-plan="basic">
									<div class="plan-header">
										<span class="plan-name">Basic</span>
										<span class="plan-price">$29/mes</span>
									</div>
									<div class="plan-desc">1 usuario, m√≥dulos esenciales</div>
								</div>
								<div class="plan-card" data-plan="pro">
									<div class="plan-header">
										<span class="plan-name">Pro</span>
										<span class="plan-price">$49/mes</span>
									</div>
									<div class="plan-desc">5 usuarios, soporte prioritario</div>
								</div>
								<div class="plan-card" data-plan="enterprise">
									<div class="plan-header">
										<span class="plan-name">Enterprise</span>
										<span class="plan-price">$99/mes</span>
									</div>
									<div class="plan-desc">Usuarios ilimitados, SLA 24/7</div>
								</div>
							</div>
						</div>

						<div id="errorBox" class="error-box hidden"></div>

						<button id="submitBtn" type="submit" class="btn-submit">
							<span>üîí</span>
							<span>Ir al pago seguro</span>
						</button>
					</form>
				</div>
			</div>
		</main>
	</div>

	<script>
	<script>
		const planCards = document.querySelectorAll('.plan-card');
		const selectedPlanInput = document.getElementById('selectedPlan');
		const errorBox = document.getElementById('errorBox');
		const submitBtn = document.getElementById('submitBtn');
		const form = document.getElementById('signupForm');

		const knownPlans = ['basic', 'pro', 'enterprise'];

		function setSelectedPlan(planId) {
			const resolvedPlan = knownPlans.includes(planId) ? planId : 'pro';
			selectedPlanInput.value = resolvedPlan;
			
			planCards.forEach(card => {
				if (card.dataset.plan === resolvedPlan) {
					card.classList.add('selected');
				} else {
					card.classList.remove('selected');
				}
			});
		}

		// Initialize from URL or default
		const params = new URLSearchParams(window.location.search);
		const planFromQuery = params.get('plan');
		setSelectedPlan(planFromQuery || selectedPlanInput.value || 'pro');

		// Prefill form from URL params
		const prefill = {
			full_name: params.get('full_name') || '',
			email: params.get('email') || '',
			company_name: params.get('company_name') || '',
			subdomain: params.get('subdomain') || ''
		};
		
		Object.entries(prefill).forEach(([key, value]) => {
			if (!value) return;
			const input = form.querySelector(`[name="${key}"]`);
			if (input) input.value = value;
		});

		// Plan selection
		planCards.forEach(card => {
			card.addEventListener('click', () => {
				setSelectedPlan(card.dataset.plan);
			});
		});

		// Form submission
		form.addEventListener('submit', async (event) => {
			event.preventDefault();
			errorBox.classList.add('hidden');
			submitBtn.disabled = true;
			submitBtn.innerHTML = '<span>‚è≥</span><span>Redirigiendo...</span>';

			const payload = {
				full_name: form.full_name.value.trim(),
				email: form.email.value.trim(),
				company_name: form.company_name.value.trim(),
				subdomain: form.subdomain.value.trim(),
				plan: selectedPlanInput.value || 'pro',
			};

			try {
				const response = await fetch('/api/checkout', {
					method: 'POST',
					headers: { 'Content-Type': 'application/json' },
					body: JSON.stringify(payload),
				});

				if (!response.ok) {
					const data = await response.json().catch(() => ({}));
					throw new Error(data.detail || 'No se pudo iniciar el checkout');
				}

				const data = await response.json();
				if (data.checkout_url) {
					window.location.href = data.checkout_url;
				} else {
					throw new Error('Respuesta inesperada del servidor');
				}
			} catch (error) {
				errorBox.textContent = error.message || 'Ocurri√≥ un error';
				errorBox.classList.remove('hidden');
				submitBtn.disabled = false;
				submitBtn.innerHTML = '<span>üîí</span><span>Ir al pago seguro</span>';
			}
		});
	</script>
</body>
</html>
